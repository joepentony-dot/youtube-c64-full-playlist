<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Juhannussauna Playlist</title>
<style>
body { font-family: Arial, sans-serif; padding: 10px; }
.letter-section { margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; }
.letter-toggle { width: 100%; background: #444; color: #fff; text-align: left; padding: 8px; font-size: 18px; border: none; cursor: pointer; }
.letter-content { display: none; padding: 10px; background: #f9f9f9; }
.letter-content.open { display: block; }
.letter-content table { width: 100%; border-collapse: collapse; }
.letter-content td { padding: 5px 10px; border-bottom: 1px solid #ddd; }
.letter-content a { color: #0066cc; text-decoration: none; }
</style>
</head>
<body>
<h2>My YouTube Playlist</h2>
<div id="playlist-container">Loading playlist...</div>

<script>
const API_KEY = "YOUR_API_KEY";  // â† paste your API key here
const PLAYLIST_ID = "PL_TYjnCNYSex7dxxCMMuOsjzcXE1VNiR9";
const container = document.getElementById("playlist-container");

// Fetch playlist items
async function fetchPlaylistItems(pageToken = "") {
  const url = new URL("https://www.googleapis.com/youtube/v3/playlistItems");
  url.search = new URLSearchParams({
    part: "snippet",
    playlistId: PLAYLIST_ID,
    maxResults: 50,
    pageToken,
    key: API_KEY,
  });

  const response = await fetch(url);
  const data = await response.json();

  let videos = data.items.map(item => ({
    title: item.snippet.title,
    url: `https://www.youtube.com/watch?v=${item.snippet.resourceId.videoId}`,
  }));

  if (data.nextPageToken) {
    videos = videos.concat(await fetchPlaylistItems(data.nextPageToken));
  }

  return videos;
}

// Normalize title (ignore 'The')
function normalizeTitle(title) {
  return title.replace(/^the\s+/i, "").toLowerCase();
}

// Build alphabetized list with expandable sections
function buildList(videos) {
  videos.sort((a, b) => normalizeTitle(a.title).localeCompare(normalizeTitle(b.title)));

  const grouped = {};
  videos.forEach(video => {
    const letter = normalizeTitle(video.title)[0].toUpperCase();
    if (!grouped[letter]) grouped[letter] = [];
    grouped[letter].push(video);
  });

  container.innerHTML = "";

  Object.keys(grouped).sort().forEach(letter => {
    const section = document.createElement("div");
    section.className = "letter-section";

    const header = document.createElement("button");
    header.className = "letter-toggle";
    header.textContent = letter;

    const content = document.createElement("div");
    content.className = "letter-content";

    header.onclick = () => content.classList.toggle("open");

    const table = document.createElement("table");
    grouped[letter].forEach(video => {
      const row = document.createElement("tr");
      const titleCell = document.createElement("td");
      const linkCell = document.createElement("td");

      titleCell.textContent = video.title;
      const link = document.createElement("a");
      link.href = video.url;
      link.textContent = "Watch";
      link.target = "_blank";
      linkCell.appendChild(link);

      row.appendChild(titleCell);
      row.appendChild(linkCell);
      table.appendChild(row);
    });

    content.appendChild(table);
    section.appendChild(header);
    section.appendChild(content);
    container.appendChild(section);
  });
}

// Load playlist
fetchPlaylistItems().then(buildList).catch(err => {
  console.error(err);
  container.textContent = "Failed to load playlist.";
});
</script>
</body>
</html>
